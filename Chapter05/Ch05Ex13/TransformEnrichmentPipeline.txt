---DROP Tables Script activity
IF OBJECT_ID (N'brainwaves.FactREADING', N'U') IS NOT NULL
 DROP TABLE [brainwaves].[FactREADING]
GO
IF OBJECT_ID (N'brainwaves.SCENARIO_FREQUENCY', N'U') IS NOT NULL
 DROP TABLE [brainwaves].[SCENARIO_FREQUENCY]

---SETUP Staging Script activity
IF OBJECT_ID (N'staging.TmpREADING', N'U') IS NOT NULL
 DELETE FROM [staging].[TmpREADING]
ELSE
  CREATE TABLE [staging].[TmpREADING]
  ( 
    [READING_ID] [int]  NOT NULL,
    [SESSION_ID] [int]  NOT NULL,
    [ELECTRODE_ID] [int]  NOT NULL,
    [FREQUENCY_ID] [int]  NOT NULL,
    [READING_DATETIME] [datetime]  NOT NULL,
    [COUNT] [int]  NOT NULL,
    [VALUE] [decimal](8,3)  NOT NULL
  )
  WITH
  (
	DISTRIBUTION = ROUND_ROBIN,
	CLUSTERED COLUMNSTORE INDEX
  )
---REMOVE Outliers Data flow
VALUE < 0.274 || VALUE > 392
